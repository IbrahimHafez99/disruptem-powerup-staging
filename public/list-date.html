<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://unpkg.com/trello/power-up/latest.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <style>
    body {
      background-color: #282E33;
      color: #fff;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input[type="submit"] {
      background-color: #0079BF;
      color: #fff;
      border: none;
      padding: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <form id="date-form">
    <label for="start-date">Start Date:</label><br>
    <input type="date" id="start-date" name="start-date"><br>
    <label for="end-date">End Date:</label><br>
    <input type="date" id="end-date" name="end-date"><br>
    <input type="submit" value="Submit">
  </form>

  <script src="https://unpkg.com/trello/power-up/latest.js"></script>
  <script>
    var t = window.TrelloPowerUp.iframe();
    var ENDPOINT_URL = "http://localhost:9000/api/v1";

    // window.TrelloPowerUp.initialize({
    //   'board-buttons': function(t, options) {
    //     return [{
    //       icon: './images/icon.svg',
    //       text: 'My Button',
    //       callback: function(t) {
    //         return t.popup({
    //           title: "Popup Title",
    //           items: function(t, options) {
    //             return [
    //               {
    //                 text: "Item 1",
    //                 callback: function(t) {
    //                   // do something when item 1 is clicked
    //                 }
    //               },
    //               {
    //                 text: "Item 2",
    //                 callback: function(t) {
    //                   // do something when item 2 is clicked
    //                 }
    //               }
    //             ];
    //           }
    //         });
    //       }
    //     }];
    //   }
    // });

    t.card('id')
    .get('id')
    .then(function(cardId) {
      fetch(`${ENDPOINT_URL}/getById/`)
      .then(response => response.json())
      .then(data => {
        document.getElementById('start-date').value = data.startDate;
        document.getElementById('end-date').value = data.endDate;
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    });

    document.getElementById('date-form').addEventListener('submit', function(event){
      event.preventDefault();
      var startDate = document.getElementById('start-date').value;
      var endDate = document.getElementById('end-date').value;

      // Here you can send a request to your API
      fetch('https://your-api.com/update', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ startDate, endDate }),
      })
      .then(response => response.json())
      .then(data => {
        console.log('Success:', data);
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    });
  </script>
</body>
</html>
